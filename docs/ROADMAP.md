# EzMap 開發路線圖

## 總覽

本路線圖規劃了 EzMap 從 MVP 到完整產品的開發歷程，預計總開發時間 **8-11 週**。

---

## Phase 1: MVP 核心功能 (Week 1-4)

### 目標
建立基礎的離線地圖與 GPS 軌跡記錄功能

### Week 1: 專案初始化與基礎架構

#### 任務清單

**專案設置**
- [ ] 建立 Flutter 專案結構
- [ ] 設定 Clean Architecture 資料夾結構
- [ ] 配置 `pubspec.yaml` 依賴套件
- [ ] 設定 Android/iOS 專案配置
- [ ] 建立 Git repository 與 .gitignore

**核心套件整合**
- [ ] 整合 `flutter_map` 套件
- [ ] 整合 `geolocator` 套件
- [ ] 整合 `permission_handler` 套件
- [ ] 整合 `sqflite` 資料庫
- [ ] 整合 `get_it` 依賴注入

**基礎功能**
- [ ] 建立 Domain Layer 基礎實體
- [ ] 建立 Database Schema 與 Helper
- [ ] 實作權限管理服務
- [ ] 建立基本的主題與路由設定

**交付成果**
- ✅ 可運行的 Flutter App 骨架
- ✅ 基礎架構完成
- ✅ 權限系統正常運作

---

### Week 2: 地圖系統與 GPS 定位

#### 任務清單

**離線地圖**
- [ ] 整合 flutter_map 地圖顯示
- [ ] 下載並整合離線地圖磁磚 (OpenStreetMap)
- [ ] 實作地圖圖層管理
- [ ] 實作地圖縮放、平移功能
- [ ] 新增地圖控制按鈕 (定位、圖層切換)

**GPS 定位**
- [ ] 實作 GpsDataSource
- [ ] 建立 LocationRepository
- [ ] 實作即時定位功能
- [ ] 顯示當前位置標記
- [ ] 地圖自動跟隨當前位置

**UI 設計**
- [ ] 設計主畫面佈局
- [ ] 實作浮動控制按鈕
- [ ] 設計底部數據面板

**交付成果**
- ✅ 可顯示離線地圖
- ✅ GPS 定位正常運作
- ✅ 地圖互動功能完整

---

### Week 3: GPX 軌跡記錄

#### 任務清單

**軌跡記錄核心**
- [ ] 整合 `gpx` 套件
- [ ] 建立 RecordingBloc
- [ ] 實作開始記錄功能
- [ ] 實作暫停/繼續記錄功能
- [ ] 實作結束記錄功能
- [ ] 實作背景定位服務

**資料處理**
- [ ] 建立 TrackPoint 資料模型
- [ ] 實作軌跡點儲存邏輯
- [ ] 實作 GPS 資料過濾 (精度、速度)
- [ ] 實作軌跡線條即時繪製

**UI 元件**
- [ ] 設計記錄控制按鈕 UI
- [ ] 實作記錄狀態指示器
- [ ] 新增記錄確認對話框
- [ ] 實作活動命名功能

**交付成果**
- ✅ 可記錄 GPS 軌跡
- ✅ 軌跡即時顯示在地圖上
- ✅ 軌跡資料正確儲存

---

### Week 4: 即時數據顯示與基礎管理

#### 任務清單

**統計資料計算**
- [ ] 實作 CalculateStatisticsUseCase
- [ ] 實作距離計算 (Haversine Formula)
- [ ] 實作爬升/下降計算
- [ ] 實作速度計算 (即時/平均)
- [ ] 實作移動時間計算

**數據面板**
- [ ] 設計數據面板 UI
- [ ] 實作即時數據更新
- [ ] 新增數據單位切換
- [ ] 實作面板展開/收合動畫

**活動管理**
- [ ] 建立活動列表頁面
- [ ] 實作活動列表載入
- [ ] 實作活動刪除功能
- [ ] 基礎的活動詳情頁面

**GPX 檔案處理**
- [ ] 實作 GPX 檔案生成
- [ ] 實作 GPX 檔案儲存
- [ ] 實作 GPX 檔案讀取

**交付成果**
- ✅ 完整的即時數據顯示
- ✅ 可查看歷史活動列表
- ✅ GPX 檔案正確儲存

---

### Phase 1 里程碑驗收標準

✅ **功能驗收**
- 可離線顯示地圖
- 可開始/暫停/結束 GPS 記錄
- 即時顯示速度、高度、距離等數據
- 軌跡正確繪製在地圖上
- 活動資料正確儲存到資料庫
- GPX 檔案正確生成

✅ **測試驗收**
- 通過基本功能測試
- GPS 定位精度測試
- 至少一次實地登山測試

✅ **效能驗收**
- App 啟動時間 < 3 秒
- 地圖載入流暢 (60fps)
- 記錄 1 小時電池消耗 < 15%

---

## Phase 2: 進階導航功能 (Week 5-7)

### 目標
增強導航能力，提供更多輔助工具

### Week 5: 指南針與距離測量

#### 任務清單

**數位指南針**
- [ ] 整合 `flutter_compass` 套件
- [ ] 建立 CompassDataSource
- [ ] 設計指南針 UI 元件
- [ ] 實作方位角顯示 (0-360°)
- [ ] 標示主要方位 (N/S/E/W)
- [ ] 實作指南針校正功能
- [ ] 新增羅盤動畫

**距離測量工具**
- [ ] 實作地圖點擊事件處理
- [ ] 實作目標點標記
- [ ] 計算直線距離
- [ ] 顯示方位角
- [ ] 支援多點測量
- [ ] 新增測量歷史記錄

**座標工具**
- [ ] 實作座標格式轉換 (DD/DMS/DDM)
- [ ] 新增座標顯示面板
- [ ] 實作座標複製功能
- [ ] 新增座標分享功能

**交付成果**
- ✅ 功能完整的數位指南針
- ✅ 可測量任意兩點直線距離
- ✅ 座標工具正常運作

---

### Week 6: 記錄點管理

#### 任務清單

**記錄點核心功能**
- [ ] 建立 Waypoint 資料模型
- [ ] 實作記錄點資料庫操作
- [ ] 建立 WaypointBloc
- [ ] 實作新增記錄點 (長按地圖)
- [ ] 實作手動標記當前位置

**記錄點 UI**
- [ ] 設計記錄點圖示系統
- [ ] 實作記錄點地圖顯示
- [ ] 建立記錄點列表頁面
- [ ] 建立記錄點詳情頁面
- [ ] 實作記錄點編輯對話框

**記錄點管理**
- [ ] 實作記錄點命名/重命名
- [ ] 實作記錄點備註功能
- [ ] 實作記錄點分類 (類型/顏色)
- [ ] 實作記錄點刪除
- [ ] 實作記錄點排序與篩選

**導航功能**
- [ ] 顯示記錄點距離與方向
- [ ] 實作「導航至記錄點」功能
- [ ] 新增到達提醒

**交付成果**
- ✅ 完整的記錄點管理系統
- ✅ 記錄點正確顯示在地圖與列表
- ✅ 可導航至任意記錄點

---

### Week 7: GPX 匯入與路線比對

#### 任務清單

**GPX 匯入**
- [ ] 實作 GPX 檔案選擇器
- [ ] 實作 GPX 解析功能
- [ ] 建立路線預覽頁面
- [ ] 實作路線匯入確認
- [ ] 處理匯入錯誤 (格式不正確等)

**路線管理**
- [ ] 建立路線資料模型
- [ ] 實作參考路線儲存
- [ ] 實作路線列表
- [ ] 實作路線顯示/隱藏切換

**雙路線顯示**
- [ ] 實作多路線同時顯示
- [ ] 設定不同顏色區分
  - 當前軌跡: 紅色 (#E53935)
  - 參考路線: 黃色 (#FDD835)
- [ ] 實作路線圖層管理
- [ ] 優化多路線渲染效能

**路線分析**
- [ ] 計算與參考路線的偏離距離
- [ ] 顯示路線完成百分比
- [ ] 實作路線對比功能

**交付成果**
- ✅ 可匯入 GPX 參考路線
- ✅ 參考路線與當前軌跡雙色顯示
- ✅ 路線對比功能正常

---

### Phase 2 里程碑驗收標準

✅ **功能驗收**
- 指南針精準運作
- 可測量任意兩點距離
- 記錄點完整管理功能
- 可匯入並顯示參考路線
- 雙路線顏色區分清楚

✅ **使用性驗收**
- 所有功能操作直覺
- UI 佈局合理
- 至少 2 次實地測試

---

## Phase 3: 數據分析與優化 (Week 8-9)

### 目標
提供深度數據分析與使用體驗優化

### Week 8: 圖表與活動分析

#### 任務清單

**圖表整合**
- [ ] 整合 `fl_chart` 套件
- [ ] 建立圖表共用元件

**高度圖表**
- [ ] 實作高度-距離折線圖
- [ ] 新增標記點顯示 (記錄點)
- [ ] 實作圖表縮放功能
- [ ] 新增高度統計資訊 (最高/最低/總爬升)

**速度圖表**
- [ ] 實作速度-時間折線圖
- [ ] 標示最快/最慢速度點
- [ ] 新增速度區間分布圖
- [ ] 實作配速分析

**活動分析報告**
- [ ] 設計分析報告頁面
- [ ] 整合所有統計數據
- [ ] 新增圖表展示區塊
- [ ] 實作報告匯出 (截圖/PDF)

**進階統計**
- [ ] 停留點檢測與分析
- [ ] 移動效率分析
- [ ] 里程碑標記 (每公里/每小時)

**交付成果**
- ✅ 美觀易讀的高度與速度圖表
- ✅ 完整的活動分析報告
- ✅ 可匯出分析結果

---

### Week 9: 日出日落與全面優化

#### 任務清單

**日出日落功能**
- [ ] 整合日出日落計算演算法
- [ ] 根據經緯度計算當日日出日落時間
- [ ] 顯示剩餘日照時間
- [ ] 新增日落前提醒通知
- [ ] 實作黃金/藍色時段顯示

**UI/UX 優化**
- [ ] 新增深色模式
- [ ] 優化按鈕觸控區域
- [ ] 新增操作提示 (首次使用)
- [ ] 優化地圖圖示尺寸
- [ ] 改進資料載入動畫
- [ ] 新增手勢操作 (滑動、長按)

**效能優化**
- [ ] 實作軌跡線簡化 (Douglas-Peucker)
- [ ] 優化大量軌跡點渲染
- [ ] 實作記錄點聚類顯示
- [ ] 優化資料庫查詢效率
- [ ] 減少記憶體佔用

**省電優化**
- [ ] 實作省電模式
- [ ] 動態調整 GPS 更新頻率
- [ ] 優化背景服務
- [ ] 新增電池使用統計

**匯出功能**
- [ ] 實作 GPX 匯出 (含記錄點)
- [ ] 整合 `share_plus` 分享功能
- [ ] 實作批次匯出
- [ ] 新增匯出格式選項 (GPX/KML)

**交付成果**
- ✅ 日出日落功能完整
- ✅ UI/UX 大幅優化
- ✅ 效能顯著提升
- ✅ 電池續航改善

---

### Phase 3 里程碑驗收標準

✅ **功能驗收**
- 所有圖表正確顯示
- 日出日落計算準確
- 所有匯出功能正常

✅ **效能驗收**
- 10000+ 軌跡點流暢顯示
- 記錄 1 小時電池消耗 < 10%
- 記憶體使用 < 150MB

✅ **體驗驗收**
- UI 美觀一致
- 操作流暢無卡頓
- 至少 3 次實地測試

---

## Phase 4: 測試、文件與發布 (Week 10-11)

### 目標
完整測試、撰寫文件並準備發布

### Week 10: 完整測試

#### 任務清單

**單元測試**
- [ ] Domain Layer 測試覆蓋率 > 80%
- [ ] Use Cases 測試覆蓋率 > 80%
- [ ] Utils 測試覆蓋率 > 90%

**Widget 測試**
- [ ] 主要畫面 Widget 測試
- [ ] 關鍵元件測試
- [ ] 互動流程測試

**整合測試**
- [ ] 完整記錄流程測試
- [ ] GPX 匯入/匯出測試
- [ ] 資料持久化測試

**實地測試**
- [ ] 不同天氣條件測試
- [ ] 不同地形環境測試 (平地/山區)
- [ ] 長時間記錄測試 (8+ 小時)
- [ ] 弱訊號/無訊號環境測試
- [ ] 極端溫度測試 (熱/冷)

**Bug 修復**
- [ ] 修復所有 Critical Bug
- [ ] 修復 Major Bug
- [ ] 記錄 Minor Bug (後續修復)

**交付成果**
- ✅ 測試覆蓋率達標
- ✅ 主要 Bug 已修復
- ✅ 至少 5 次實地測試通過

---

### Week 11: 文件撰寫與發布準備

#### 任務清單

**使用者文件**
- [ ] 撰寫使用說明文件
- [ ] 製作功能介紹截圖
- [ ] 錄製操作示範影片
- [ ] 撰寫 FAQ 常見問題

**開發者文件**
- [ ] 完善 README.md
- [ ] 撰寫 API 文件
- [ ] 撰寫部署指南
- [ ] 撰寫貢獻指南 (CONTRIBUTING.md)

**App Store 準備**
- [ ] 準備應用程式圖示 (多尺寸)
- [ ] 準備應用程式截圖 (iOS/Android)
- [ ] 撰寫應用程式描述
- [ ] 撰寫更新日誌
- [ ] 準備隱私權政策
- [ ] 準備使用條款

**Android 發布**
- [ ] 產生簽署金鑰
- [ ] 設定 build.gradle
- [ ] 建立 Release APK/AAB
- [ ] 上傳至 Google Play Console
- [ ] 設定內部測試軌道

**iOS 發布**
- [ ] 設定 App ID 與憑證
- [ ] 配置 Xcode 專案
- [ ] 建立 Archive
- [ ] 上傳至 App Store Connect
- [ ] 設定 TestFlight Beta 測試

**Beta 測試**
- [ ] 招募 10-20 位 Beta 測試者
- [ ] 收集回饋
- [ ] 修正問題

**交付成果**
- ✅ 完整的使用者文件
- ✅ App Store 素材完備
- ✅ Beta 版本成功發布

---

### Phase 4 里程碑驗收標準

✅ **測試驗收**
- 所有測試通過
- 無 Critical Bug
- 實地測試成功

✅ **文件驗收**
- 使用說明清晰完整
- 開發文件齊全

✅ **發布驗收**
- Beta 版本上線
- 收集至少 10 位測試者回饋

---

## Phase 5: 正式發布與後續維護 (Week 12+)

### Week 12: 正式發布

#### 任務清單

**發布前最後檢查**
- [ ] 最終測試
- [ ] 效能檢測
- [ ] 安全性檢查
- [ ] 法律合規檢查

**正式發布**
- [ ] 提交 Google Play 審核
- [ ] 提交 App Store 審核
- [ ] 準備發布公告
- [ ] 設定應用程式網站

**推廣**
- [ ] 社群媒體宣傳
- [ ] 登山論壇介紹
- [ ] 製作宣傳素材

---

## 未來功能規劃 (Post v1.0)

### v1.1 (1-2 個月後)

**多語言支援**
- [ ] 英文介面
- [ ] 簡體中文
- [ ] 日文

**照片整合**
- [ ] 記錄點附加照片
- [ ] 照片地理標記
- [ ] 照片時間軸

**自訂化**
- [ ] 自訂主題顏色
- [ ] 自訂地圖圖層
- [ ] 自訂資料顯示項目

---

### v1.2 (3-4 個月後)

**離線資料包**
- [ ] 地圖下載管理器
- [ ] 自訂下載區域
- [ ] 多圖層支援

**進階分析**
- [ ] 體能負荷分析
- [ ] 路線難度評估
- [ ] 訓練效果評估

---

### v2.0 (6-12 個月後)

**雲端功能**
- [ ] 雲端備份 (選擇性)
- [ ] 多裝置同步
- [ ] 社群路線分享

**智慧功能**
- [ ] AI 路線推薦
- [ ] 天氣警報整合
- [ ] 山岳資料庫

**穿戴裝置**
- [ ] Apple Watch 支援
- [ ] Wear OS 支援
- [ ] 心率監測整合

---

## 資源配置建議

### 人力資源

**MVP 階段 (Phase 1-2)**
- Flutter 開發者 x 1 (全職)
- UI/UX 設計師 x 1 (兼職，週 2-3 天)

**完整版 (Phase 3-4)**
- Flutter 開發者 x 1 (全職)
- 測試工程師 x 1 (兼職)

---

## 風險管理

### 技術風險

| 風險 | 機率 | 影響 | 應對策略 |
|------|------|------|----------|
| GPS 精度不足 | 中 | 高 | 使用 Kalman Filter，允許手動校正 |
| 離線地圖檔案過大 | 高 | 中 | 分區下載，優化壓縮 |
| 背景定位被系統殺掉 | 中 | 高 | 使用 Foreground Service |
| 電池消耗過快 | 中 | 高 | 省電模式，可調參數 |

### 時程風險

| 風險 | 應對策略 |
|------|----------|
| 功能開發延遲 | 優先完成 P0 功能，P1/P2 可延後 |
| 測試發現重大 Bug | 預留 1 週 Buffer Time |
| App 審核被拒 | 提前了解審核規範，準備申訴 |

---

## 成功指標 (KPI)

### MVP 階段
- ✅ 完成所有 P0 功能
- ✅ 至少 3 次成功的實地測試
- ✅ 電池續航達標 (1 小時 < 15%)

### Beta 階段
- ✅ 招募到 10+ Beta 測試者
- ✅ 收到正面回饋 > 70%
- ✅ 平均評分 > 4.0

### 正式發布後 (3 個月內)
- 📊 下載量 > 1,000
- 📊 日活躍用戶 > 100
- 📊 平均評分 > 4.2
- 📊 崩潰率 < 1%

---

## 總結

這個路線圖提供了清晰的開發路徑，從 MVP 到完整產品。關鍵成功因素：

1. **專注於核心功能**: Phase 1-2 完成最重要的導航功能
2. **迭代開發**: 每個 Phase 都有可驗證的交付成果
3. **實地測試**: 定期在真實環境中測試
4. **使用者回饋**: Beta 測試收集真實使用者意見
5. **彈性調整**: 根據實際進度調整優先級

預計 **第 4 週**可完成 MVP，**第 11 週**可發布 Beta 版本！

---

**文件版本**: v1.0  
**最後更新**: 2025-11-06  
**下次檢視日期**: 每週五

